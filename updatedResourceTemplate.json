{"$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#", "contentVersion": "1.0.0.0", "resources": [{"name": "[parameters('virtualMachineScaleSets_bishal6vm_name')]", "type": "Microsoft.Compute/virtualMachineScaleSets", "apiVersion": "2016-04-30-preview", "properties": {"virtualMachineProfile": {"osProfile": {"windowsConfiguration": {"provisionVMAgent": true, "enableAutomaticUpdates": true}, "secrets": [], "adminUsername": "tfs", "computerNamePrefix": "[parameters('virtualMachineScaleSets_bishal6vm_name')]"}, "networkProfile": {"networkInterfaceConfigurations": [{"properties": {"ipConfigurations": [{"properties": {"loadBalancerBackendAddressPools": [{"id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_bishal6vmlb_name')), concat('/backendAddressPools/', parameters('virtualMachineScaleSets_bishal6vm_name'),'bepool'))]"}], "subnet": {"id": "[concat(resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_bishal6vmvnet_name')), concat('/subnets/', parameters('virtualMachineScaleSets_bishal6vm_name'),'subnet'))]"}, "loadBalancerInboundNatPools": [{"id": "[concat(resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_bishal6vmlb_name')), concat('/inboundNatPools/', parameters('virtualMachineScaleSets_bishal6vm_name'),'natpool'))]"}]}, "name": "[concat(parameters('virtualMachineScaleSets_bishal6vm_name'),'ipconfig')]"}], "primary": true}, "name": "[concat(parameters('virtualMachineScaleSets_bishal6vm_name'),'nic')]"}]}, "storageProfile": {"osDisk": {"caching": "ReadOnly", "name": "[concat(parameters('virtualMachineScaleSets_bishal6vm_name'),'osdisk')]", "createOption": "FromImage", "osType": "Windows", "image": "[parameters('imageUrl')]"}}}, "singlePlacementGroup": true, "overprovision": true, "upgradePolicy": {"mode": "Automatic"}}, "sku": {"name": "Standard_D3_v2", "tier": "Standard", "capacity": 2}, "location": "SouthIndia", "dependsOn": ["[resourceId('Microsoft.Network/virtualNetworks', parameters('virtualNetworks_bishal6vmvnet_name'))]", "[resourceId('Microsoft.Network/loadBalancers', parameters('loadBalancers_bishal6vmlb_name'))]"]}, {"name": "[parameters('loadBalancers_bishal6vmlb_name')]", "type": "Microsoft.Network/loadBalancers", "apiVersion": "2016-03-30", "properties": {"frontendIPConfigurations": [{"properties": {"privateIPAllocationMethod": "Dynamic", "publicIPAddress": {"id": "[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_bishal6vmpip_name'))]"}}, "name": "LoadBalancerFrontEnd"}], "backendAddressPools": [{"name": "bishal6vmbepool"}], "probes": [{"properties": {"protocol": "Tcp", "port": 80, "numberOfProbes": 2, "intervalInSeconds": 5}, "name": "tcpProbe"}], "inboundNatRules": [{"properties": {"protocol": "Tcp", "frontendPort": 50001, "frontendIPConfiguration": {"id": "[parameters('loadBalancers_bishal6vmlb_id_3')]"}, "backendPort": 3389}, "name": "bishal6vmnatpool.1"}, {"properties": {"protocol": "Tcp", "frontendPort": 50002, "frontendIPConfiguration": {"id": "[parameters('loadBalancers_bishal6vmlb_id_4')]"}, "backendPort": 3389}, "name": "bishal6vmnatpool.2"}], "outboundNatRules": [], "loadBalancingRules": [{"properties": {"frontendPort": 80, "frontendIPConfiguration": {"id": "[parameters('loadBalancers_bishal6vmlb_id')]"}, "probe": {"id": "[parameters('loadBalancers_bishal6vmlb_id_2')]"}, "protocol": "Tcp", "backendAddressPool": {"id": "[parameters('loadBalancers_bishal6vmlb_id_1')]"}, "idleTimeoutInMinutes": 5, "backendPort": 80, "loadDistribution": "Default", "enableFloatingIP": false}, "name": "LBRule"}], "inboundNatPools": [{"properties": {"protocol": "Tcp", "frontendIPConfiguration": {"id": "[parameters('loadBalancers_bishal6vmlb_id_5')]"}, "backendPort": 3389, "frontendPortRangeStart": 50000, "frontendPortRangeEnd": 50119}, "name": "bishal6vmnatpool"}]}, "location": "southindia", "dependsOn": ["[resourceId('Microsoft.Network/publicIPAddresses', parameters('publicIPAddresses_bishal6vmpip_name'))]"]}, {"name": "[parameters('publicIPAddresses_bishal6vmpip_name')]", "type": "Microsoft.Network/publicIPAddresses", "apiVersion": "2016-03-30", "properties": {"publicIPAllocationMethod": "Dynamic", "dnsSettings": {"domainNameLabel": "bishal6vmss"}, "idleTimeoutInMinutes": 4}, "location": "southindia", "dependsOn": []}, {"name": "[parameters('virtualNetworks_bishal6vmvnet_name')]", "type": "Microsoft.Network/virtualNetworks", "apiVersion": "2016-03-30", "properties": {"subnets": [{"properties": {"addressPrefix": "10.0.0.0/24"}, "name": "bishal6vmsubnet"}], "addressSpace": {"addressPrefixes": ["10.0.0.0/16"]}}, "location": "southindia", "dependsOn": []}, {"name": "[parameters('storageAccounts_es3d5tcsfkytebishal6vmsa_name')]", "tags": {}, "type": "Microsoft.Storage/storageAccounts", "apiVersion": "2016-01-01", "properties": {}, "sku": {"name": "Standard_LRS", "tier": "Standard"}, "location": "southindia", "kind": "Storage", "dependsOn": []}, {"name": "[parameters('storageAccounts_jpgtjs4b2hz6ubishal6vmsa_name')]", "tags": {}, "type": "Microsoft.Storage/storageAccounts", "apiVersion": "2016-01-01", "properties": {}, "sku": {"name": "Standard_LRS", "tier": "Standard"}, "location": "southindia", "kind": "Storage", "dependsOn": []}, {"name": "[parameters('storageAccounts_mppendwnzufqebishal6vmsa_name')]", "tags": {}, "type": "Microsoft.Storage/storageAccounts", "apiVersion": "2016-01-01", "properties": {}, "sku": {"name": "Standard_LRS", "tier": "Standard"}, "location": "southindia", "kind": "Storage", "dependsOn": []}, {"name": "[parameters('storageAccounts_setga3d7rrzk2bishal6vmsa_name')]", "tags": {}, "type": "Microsoft.Storage/storageAccounts", "apiVersion": "2016-01-01", "properties": {}, "sku": {"name": "Standard_LRS", "tier": "Standard"}, "location": "southindia", "kind": "Storage", "dependsOn": []}, {"name": "[parameters('storageAccounts_ughfrk7k3eoqgbishal6vmsa_name')]", "tags": {}, "type": "Microsoft.Storage/storageAccounts", "apiVersion": "2016-01-01", "properties": {}, "sku": {"name": "Standard_LRS", "tier": "Standard"}, "location": "southindia", "kind": "Storage", "dependsOn": []}], "variables": {}, "parameters": {"storageAccounts_setga3d7rrzk2bishal6vmsa_name": {"defaultValue": null, "type": "String"}, "imageUrl": {"defaultValue": "", "type": "String"}, "loadBalancers_bishal6vmlb_id_4": {"type": "String"}, "virtualNetworks_bishal6vmvnet_name": {"defaultValue": null, "type": "String"}, "storageAccounts_jpgtjs4b2hz6ubishal6vmsa_name": {"defaultValue": null, "type": "String"}, "storageAccounts_es3d5tcsfkytebishal6vmsa_name": {"defaultValue": null, "type": "String"}, "loadBalancers_bishal6vmlb_id_3": {"type": "String"}, "publicIPAddresses_bishal6vmpip_name": {"defaultValue": null, "type": "String"}, "loadBalancers_bishal6vmlb_name": {"defaultValue": null, "type": "String"}, "loadBalancers_bishal6vmlb_id_5": {"type": "String"}, "virtualMachineScaleSets_bishal6vm_name": {"defaultValue": null, "type": "String"}, "loadBalancers_bishal6vmlb_id": {"type": "String"}, "storageAccounts_ughfrk7k3eoqgbishal6vmsa_name": {"defaultValue": null, "type": "String"}, "storageAccounts_mppendwnzufqebishal6vmsa_name": {"defaultValue": null, "type": "String"}, "loadBalancers_bishal6vmlb_id_1": {"type": "String"}, "loadBalancers_bishal6vmlb_id_2": {"type": "String"}}}